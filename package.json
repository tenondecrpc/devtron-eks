{
  "name": "eks-cdk",
  "version": "0.1.0",
  "bin": {
    "main": "bin/main.js"
  },
  "scripts": {
    "build": "tsc",
    "test": "jest",
    "cdk": "cdk",
    "deploy": "cdk deploy --require-approval never --profile AWS_PROFILE",
    "destroy": "cdk destroy --profile AWS_PROFILE",
    "connect": "echo 'Para conectar al cluster EKS:' && echo '' && echo '1. OpciÃ³n automÃ¡tica (usa el nombre por defecto):' && echo '   npm run connect-cluster' && echo '' && echo '2. OpciÃ³n manual (especifica el nombre del cluster):' && echo '   aws eks update-kubeconfig --region us-east-1 --name devtron-dev-cluster --profile AWS_PROFILE' && echo '' && echo 'DespuÃ©s de conectar, verifica con:' && echo '   npm run status'",
    "connect-cluster": "echo 'Conectando al cluster EKS...' && aws eks update-kubeconfig --region us-east-1 --name devtron-dev-cluster --profile AWS_PROFILE && echo 'âœ… ConexiÃ³n configurada. Verificando...' && kubectl cluster-info",
    "status": "kubectl cluster-info && kubectl get nodes",
    "pods": "kubectl get pods -A",
    "services": "kubectl get svc -A",
    "nodes": "kubectl get nodes --label-columns=eks.amazonaws.com/nodegroup",
    "events": "kubectl get events --sort-by=.metadata.creationTimestamp",
    "logs": "kubectl logs",
    "fix-devtron-service": "echo 'ðŸ”§ Asegurando configuraciÃ³n correcta del servicio Devtron...' && echo '   Verificando y corrigiendo selector del servicio si es necesario' && kubectl patch svc devtron-service -n devtroncd --type merge -p '{\"spec\":{\"selector\":{\"app\":\"dashboard\"}}}' && echo 'âœ… Servicio verificado/corrigido.'",
    "port-forward-devtron": "echo 'ðŸŒ Para acceder a Devtron:' && echo '' && echo '1. Ejecuta en una terminal separada:' && echo '   kubectl port-forward svc/devtron-service -n devtroncd 8080:80' && echo '' && echo '2. Abre tu navegador en:' && echo '   http://localhost:8080' && echo '' && echo '3. Credenciales:' && echo '   Usuario: admin' && kubectl get secret devtron-secret -n devtroncd -o jsonpath='{.data.ADMIN_PASSWORD}' | base64 -d | xargs echo '   ContraseÃ±a:' && echo '' && echo 'Para detener: Ctrl+C en la terminal'",
    "devtron-status": "echo 'ðŸ“Š InformaciÃ³n de acceso a Devtron...' && echo 'Port-forward command:' && echo 'kubectl port-forward svc/devtron-service -n devtroncd 8080:80' && echo '' && echo 'URL: http://localhost:8080' && echo '' && echo 'Usuario: admin' && echo 'ContraseÃ±a:' && kubectl get secret devtron-secret -n devtroncd -o jsonpath='{.data.ADMIN_PASSWORD}' | base64 -d",
    "time-estimates": "echo 'â±ï¸ TIEMPOS ESTIMADOS DE INSTALACIÃ“N â±ï¸' && echo '' && echo 'ðŸ“‹ PROCESO COMPLETO: 15-45 minutos' && echo '' && echo 'â”œâ”€â”€ CDK Deploy: 5-15 minutos' && echo 'â”œâ”€â”€ Helm Install Devtron: 3-8 minutos' && echo 'â”œâ”€â”€ InicializaciÃ³n completa: 10-20 minutos' && echo 'â””â”€â”€ Total aproximado: 15-45 minutos' && echo '' && echo 'ðŸ’¡ Usa \"npm run status\" para ver progreso actual'",
    "progress": "echo 'ðŸ“ˆ ESTADO ACTUAL DE INSTALACIÃ“N ðŸ“ˆ' && echo '' && echo 'ðŸ” Cluster EKS:' && kubectl get nodes --no-headers | wc -l | xargs echo '   Nodos:' && kubectl get nodes --no-headers -o custom-columns=INSTANCE:.spec.providerID | head -1 | sed 's/.*i-//' | sed 's/\\/.*//' | xargs echo '   Tipo de instancia:' && echo '' && echo 'ðŸ³ Pods Devtron:' && kubectl get pods -n devtroncd --no-headers 2>/dev/null | wc -l | xargs echo '   Total pods:' && kubectl get pods -n devtroncd --no-headers 2>/dev/null | grep -c Running | xargs echo '   Pods corriendo:' && echo '' && echo 'ðŸ“Š Estado instalaciÃ³n:' && kubectl get installers installer-devtron -n devtroncd -o jsonpath='{.status.sync.status}' 2>/dev/null | xargs echo '   Devtron:' || echo '   Devtron: AÃºn no disponible' && echo '' && echo 'ðŸŒ Acceso: kubectl port-forward svc/devtron-service -n devtroncd 8080:80'",
    "cost-analysis": "echo 'ðŸ’° ANÃLISIS DE COSTOS ðŸ’°' && echo '' && echo 'ðŸ“Š ConfiguraciÃ³n Actual:' && kubectl get nodes --no-headers -o custom-columns=INSTANCE:.spec.providerID | head -1 | sed 's/.*i-//' | sed 's/\\/.*//' | xargs echo '   Tipo de instancia:' && kubectl get nodes --no-headers | wc -l | xargs echo '   NÃºmero de nodos actuales:' && echo '   Escalado automÃ¡tico: 3-8 nodos (dev) / 3-15 nodos (prod)' && echo '' && echo 'ðŸ’µ EstimaciÃ³n mensual (us-east-1):' && echo '   t3.medium (2vCPU, 4GB): ~$25-30/nodo' && echo '   t3.large (2vCPU, 8GB): ~$55-65/nodo' && echo '' && echo 'ðŸ” Recomendaciones:' && kubectl get pods -n devtroncd --no-headers 2>/dev/null | wc -l | xargs echo '   Pods Devtron:' && echo '   âœ… Para desarrollo: t3.medium + 3-8 nodos' && echo '   âš¡ Para producciÃ³n: t3.large + 3-15 nodos'"
  },
  "devDependencies": {
    "@types/dotenv": "^6.1.1",
    "@types/jest": "^29.5.14",
    "@types/node": "22.7.9",
    "aws-cdk": "2.1026.0",
    "jest": "^29.7.0",
    "ts-jest": "^29.2.5",
    "ts-node": "^10.9.2",
    "typescript": "~5.6.3"
  },
  "dependencies": {
    "@aws-cdk/aws-eks-v2-alpha": "^2.213.0-alpha.0",

    "aws-cdk-lib": "^2.213.0",
    "constructs": "^10.0.0",
    "dotenv": "^17.2.1"
  }
}
